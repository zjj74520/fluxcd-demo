provider "kubernetes" {
  host = https://192.168.189.3:6443
  client_certificate     = TFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVTTFla05EUVdNclowRjNTVUpCWjBsQ1FVUkJUa0puYTNGb2EybEhPWGN3UWtGUmMwWkJSRUZXVFZKTmQwVlJXVVJXVVZGRVJYZHdjbVJYU213S1kyMDFiR1JIVm5wTlFqUllSRlJKZWsxRVRYZE9ha1YzVFhwQmVrMVdiMWhFVkUxNlRVUk5kMDE2UlhkTmVrRjZUVlp2ZDBaVVJWUk5Ra1ZIUVRGVlJRcEJlRTFMWVROV2FWcFlTblZhV0ZKc1kzcERRMEZUU1hkRVVWbEtTMjlhU1doMlkwNUJVVVZDUWxGQlJHZG5SVkJCUkVORFFWRnZRMmRuUlVKQlMwWnBDbUpJVVUxaWRrOUljbTE0Y3k5blVrSkJOalUxYjIxUWNWVjNRMU52WnpZeVNGWnJRVkZDTDJGcGVWVjJVM2R2Tm1OeFZHWnBSQzltTkRsa1F5dEVibGtLYTJaR1luQTRjemhqYm5CeGFrRm5aMnBaWlM5cVpWbEpNbGhPTWpKRGVYTktNR2dyVlVOYVFWaE1XRVJYV25WcWRsbFViSEphWm5WYVIzVkliVlF5TUFwVmRqZERZWFJ6ZDJkMmJtRkNOSFZsTmpsVmNXdGlVMHcyWjBjeWNYRlVRVWhMY1haU05EaFlaa1ZZWjJncmVVWTBZalJaS3psME0zcFFVV0pQYkdoMkNsUm9TMVkwT1hsRGVtUmlRMmxqTkdkV2VtaDRTa3RuU0dSNVdrVjNURkpxYVc5Q2NrMTRhazFWZVc1UVIxRnhOelpsYzNFNWFWTmhPRzlxVkZSMlJsVUtiR0pGTVhwSlRpdEdNQ3NyVm5oUU5scDBVRzF0Vnl0MWVGUlhjMU5DWVc5dVoxTkhlWFpEYzBjNFRqUjNWSFV6YTFwbGJHVkVURkJRVTIxTVNteE1WUXBSZEdscmNrOXJjbk5QZDBNd0swMUpTbUU0UTBGM1JVRkJZVTVEVFVWQmQwUm5XVVJXVWpCUVFWRklMMEpCVVVSQlowdHJUVUU0UjBFeFZXUkZkMFZDQ2k5M1VVWk5RVTFDUVdZNGQwaFJXVVJXVWpCUFFrSlpSVVpGYVdSdmJUZHFhV2RpYlhRNVdXTlFhVzlWTkVrd09UQkRhMVZOUVRCSFExTnhSMU5KWWpNS1JGRkZRa04zVlVGQk5FbENRVkZDTVRsaVRYSlVXR0pXZERZeGVIUnlVM2d5Ymk5NFVuUnlOSGtyT1hkMFZHTlJOV2hHV2xORkwwaG9keTlzYkRkall3cFVNV1ZHVjFWMVdqWTRkRGRtWlZBMGFqSkJSWEZyUW00MlVGcHRNQzlrVW1OMVNXbGlWbVJ0VjFKbGEwZGlZek5GVEdaaVdUSnRRblpGYjNCbWVYZEZDalI1Umt4SWJIaDZVM0F4VTNvM1FWTXlSbU5pVEdoRVMyVnFOSEpGZDBzeFVWTlhja3BFTm1ONWFFeFBPRlZaVGt4aGMzcGhiREV6Tm5SVGFGbFFMMlFLT1VKNVkwcHliMUUyUkdGWFFuVXlaak01Y0RSb01IaFhhbTFhVEhwdFdEQndhMk13WVd4YVpXNVhaRU5JUW5SSGJHVm5iVm92TkV4UlJuaEZhblZaWlFwMmNGUkxVMDFwUWtnMU0wWlBRVU5zY21OVFRVcENkMVJXTTNSaFNGSjVNbkZRWTBkc0sxUlJSMDVQVWtOMWRsTnNVM1ZXUTBGeFExQmxjbTVWTW5oUkNqaE5XWFZVWVdoMmVFSmxUV3RKYVVSVVdFTlNibUZOVDFWWFVtUnlURFJpVUhGRVJRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0K
  client_key             = TFMwdExTMUNSVWRKVGlCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRcE5TVWxGYjNkSlFrRkJTME5CVVVWQmREWnBhVTVZTWxsUE9GQkpOamgyUkdOc2VtOUlTa3hEV2toeU1EUk1OMGxsZGpOTFRWQTBRa2hrVlRGb2JtdzNDbXg0YldJMmNIRXdjVWhKUzAxRlRGRkxUM2w1U1RFeVZqQnpWWG81VDJOR01GTjRZa0ZxTUVVeE0yazNORFpaU0RWTFVtdFRNbk01Y1dOTmRqVXpiRGdLYlRoc1VWUXlVVVYxYnpWNFkzaFhSMWRzWVZkNVEwVnhjVVk0UVRCVlpFNUxRbFpIZUhBeWJVbGpVVVJCWTFsc2RURTVWRGd3WlVneFlWQTRTMEpyUndwUU5VOVpUMUZ5WW1wVE1sZ3hlbXBaZGtGdWNHNTNaa2xoWlRNek5sTTRVa294VVV3MFVFazNlbFJKYUd3emNuTnViM0pMVEdKVVpUUk9OVzFUVkRCUUNtdDZkRW80T1ZNeFNqbHpkMGhoU0RSTE0wbERTV1ppUzNsNlIzSkZjR0l3VkdjME5rWnRVMWhUWkZaQllXeFNNMWhvYjBKWVRYTnpWRGhtSzFaaWVYWUthWGhxWTI5Q2VuRlFhemQ1VmpJMFQwRmlhR2RvUlRGcFNrOTRhSGg0VUdOU1dqVmhZM2RKUkVGUlFVSkJiMGxDUVZGRFIyWXJXVVJJUnpWMldHdDBNd3BsTm5OMmVIRkNjSGhKVXl0U01XMXpaV0YxYVdaMFoycEdka2hGV1dzNGJtOTZTVU5xTUhWcEwxSmtUM2RQTVRkUFNVeDJXbUZDZW5rcllXTkROMWR2Q2twalVWb3djM296YWpZMVRFTnRNRE5KTTBadFdGbHVhSFppUkZRNFZrUlZlVk5EWW1scmRscFRSbk0yVFVoVlpraGxWbVJ3Vlc5YVYwVnFRVTAwYzBzS2RVcG1iSGRsWTNGTU1uWnhSVWd4VUZGRmFVUjBlVlp2TldKeGVHeHVNMHhWTVRsUVFTOVRNbVU0Ym1zNFJ6TkdOa0ZVTjFGd1dFeHllVXRGVjNrdldBb3JLekJ3UTI1UVkwOVNhRVJ3VVhCS1psa3pXa2R5WkRjeVJYQk5UVXBzUmpsT1JsbFNORUk1TVZSb09XSlpkV3A0ZFVFdlJ5dFpWVFpQWTJFNEsxWm1Da2RYWm5OeFUwUmxUVlZ6TDJkeVltaEtaMk12ZDJsVVZYazNSMlJFVkU5ME1sSTBZVWR4YTFCNVQxUTNTa1pzU0dObVNubDZOMFY2YWpkd2IzTkVRMmdLVFdOWEsxaFZhSGhCYjBkQ1FWQkxaR00yVEROQmJDOTFPRWhoY21Sb1Uyb3ZjRVZZTm5nMU5FNVdiVnBwVG1ab1RWRlRWREZCZDFGa1NFUjZUM1JqUmdvek1ISXZTMU40TWs5dlJsTm5Xa2hwVTNnMlEwZG9kSEppUkdjMFQwbFZaak41UWpsRlVuUjJieTl1UkU1M2EwMXZkVVI2Y1djdk1qUlBkMDVtUXpoRENrbFZjRWhsUW1reU5XWkRWVTVEYjNsM2FsRXhia1JGV0RBMlkyTnBkalp2WjB4WFlsZHhTamxXVVdabGIxQXhlVVZzZVhBNFZtUmlRVzlIUWtGTlNFc0thRXh5TlRCc1prRmpXVkZNVFd3dk1VVnhNR3BZTkdzemVqVkdTR0pZZERGWlEzVnhOWFEyUXpVMlZuRkVTR1ZhYkM5alZVbGlNVmdyZWsxUE9YQmFWZ3BuTTBZeWRWcHhjems1YlM5WksxTmtOakJZTUZCaVQzQjBkbGhSWm5aU1RXRTJNV2hKTW5SRFVUUldjM2RwZW5adE1GQk9TRzFPVURCa1drOURjWGx4Q2xwQ1dubzRaSGR5WTNwb1NWWndOekJ2VWtrcmJVcENOV1J0U0Vac1lWbE5aMWRtVFVGWmVrcEJiMGRCUzNNNE1XeEZMMXBxTW5aME5tdExaVGt3TVc4S2IyUnRRMnd3U0VkNVExTmlWRTU0YW1Sa1pGQXhNRVZuUTNJMFoxbzRhVlpsWm5CRlNHRkNUeXR1Y2tGbGFXeG1OeXRaZEVSVFIweFhka0YzY1U5NlV3cDRhbnBNVVM5blZFTjNUWHBPZEcxUU9DOXRTM3BJTlZobFl6a3pWbWxSWlVVMmJFRjFOM1Z4U0hsV1NHWjRjWFIzWlVOcWVYUllWbVIxZEVkaE1rUTBDazVTVGxGcWRFNXRjVnBxVXpreVYyeGlPSGhqTVZoclEyZFpRbmhWY2tKVVpHOTFaV0pTWWpCc1IyVmpNMWc1VTJGQlJWTkRUMVZGYlRkU1YwbGpiR1lLVURneFMwTldjbFY2UkUxSFRGaGtSVTFUTWxwMk56RlNiV3R3ZDJ4M2EwdGlUbU5WYzBacmRuRkdRVTR2U25JNGFWWnpZbTFRT0RSMEwyWkdaa2h5Y2dwS1NXSkdlbXBaVmpkQlpWRndNekIzU2s0M1JWUkpWREIzVTFwVk1tbzRNVTFvUVZwSkx6azBlR3BUUWs0MlUwcFBjbTFWYjNKTGNtTm9UMVY1Yms1U0NqZ3lXbXR2VVV0Q1owTjFUa05hUjBWUFRrczFUemd4UWxFeVZXOHphbnA1YjNKUlNYTk1jVEpUYzIwdmNHUmtXbkY1Y1dsTlpXZ3pRVnA0YlUxb1JtY0tRelY1T0ZCeWRsUk1PWGM1WlhOT01qUTVkalpXUVZsR2FIUXZWMVl6V1VOeVpHZDBRa05hWm5rdk5HOWlSbGhRV2tsWksxWnRhamN5WVdvd2QwaFNhZ3BqZGpoUmJtRnlaek42VEZwTVJHSTFLMGRUZDBJcllqQnZjMHRTVkhwTFZDOVhMMGhxT1hWTVNFTnhjRXczYzNOVVJDOWxDaTB0TFMwdFJVNUVJRkpUUVNCUVVrbFdRVlJGSUV0RldTMHRMUzB0Q2c9PQo= 
  cluster_ca_certificate = TFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVUkpWRU5EUVdkdFowRjNTVUpCWjBsSldFNWxWbm9yUTA1d1FXZDNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRWGRHVkVWVVRVSkZSMEV4VlVVS1FYaE5TMkV6Vm1sYVdFcDFXbGhTYkdONlFXVkdkekI1VFhwQmVrMUVXWGhOUkUxM1RYcEdZVVozTUhsT1JFRjZUVVJWZUUxRVRYZE5lbEpoVFVSUmVBcEdla0ZXUW1kT1ZrSkJiMVJFYms0MVl6TlNiR0pVY0hSWldFNHdXbGhLZWsxU2EzZEdkMWxFVmxGUlJFVjRRbkprVjBwc1kyMDFiR1JIVm5wTVYwWnJDbUpYYkhWTlNVbENTV3BCVGtKbmEzRm9hMmxIT1hjd1FrRlJSVVpCUVU5RFFWRTRRVTFKU1VKRFowdERRVkZGUVhRMmFXbE9XREpaVHpoUVNUWTRka1FLWTJ4NmIwaEtURU5hU0hJd05FdzNTV1YyTTB0TlVEUkNTR1JWTVdodWJEZHNlRzFpTm5CeE1IRklTVXROUlV4UlMwOTVlVWt4TWxZd2MxVjZPVTlqUmdvd1UzaGlRV293UlRFemFUYzBObGxJTlV0U2ExTXljemx4WTAxMk5UTnNPRzA0YkZGVU1sRkZkVzgxZUdONFYwZFhiR0ZYZVVORmNYRkdPRUV3VldST0NrdENWa2Q0Y0RKdFNXTlJSRUZqV1d4MU1UbFVPREJsU0RGaFVEaExRbXRIVURWUFdVOVJjbUpxVXpKWU1YcHFXWFpCYm5CdWQyWkpZV1V6TXpaVE9GSUtTakZSVERSUVNUZDZWRWxvYkROeWMyNXZja3RNWWxSbE5FNDFiVk5VTUZCcmVuUktPRGxUTVVvNWMzZElZVWcwU3pOSlEwbG1Za3Q1ZWtkeVJYQmlNQXBVWnpRMlJtMVRXRk5rVmtGaGJGSXpXR2h2UWxoTmMzTlVPR1lyVm1KNWRtbDRhbU52UW5weFVHczNlVll5TkU5QlltaG5hRVV4YVVwUGVHaDRlRkJqQ2xKYU5XRmpkMGxFUVZGQlFtOHhXWGRXUkVGUFFtZE9Wa2hST0VKQlpqaEZRa0ZOUTBKaFFYZEZkMWxFVmxJd2JFSkJkM2REWjFsSlMzZFpRa0pSVlVnS1FYZEpkMFJCV1VSV1VqQlVRVkZJTDBKQlNYZEJSRUZtUW1kT1ZraFRUVVZIUkVGWFowSlNTVzVoU25VME5HOUhOWEptVjBoRU5IRkdUME5PVUdSQmNBcEdSRUZPUW1kcmNXaHJhVWM1ZHpCQ1FWRnpSa0ZCVDBOQlVVVkJWM1JxVEhwNlIyeFRSV2hCYW5oTE0wUjFhRXRhWlhaRGMwcERiMkpGYUcwdllsZzBDbUV6WlVsNVpFSnZPVUZDYzNwRlJqaEJkMkZ1TVdKQlEweFZSRkJCY1hCblVIbE5aMGRLUkN0cmJrUjVkMWRITlRCNk9FbEllR29yUzBsS1ZFUnRVSFVLUTBwSlduTnBlSEZSVFROYVpXdG9ReTl2TTFaRVZVZEhRMHQ2U25aRFJHbE5aelZaYkRSNVVqWjBOMlJWZDAxTVRISkpaMXBwUkd4bWQyMWtkMVZrZUFwM1dXZGFMMWhaUTFKVmIzbGFMMlJDYVZWdVpVMXNVRlpuWVZST1YwcHFNblJLZFVGUWRFaHFjbk0zYW5wQ1UzaHFVbTFSVGxwamQyNWxNalpHVmtWNENtMXNWRzV0TkhWaGIzTnlibGxCZEZBeGJ6ZE1hVEF5U0VKaFpXTm9ORW96WjNVeWJIUkdTakExZFVRMlp6TjNPVlpEY25aTWNEQmxNVU4zVEZGNGVEZ0thbE5GYld0d2Mya3dOekZVU0M5a2FERndRelJEYVROdk5FRnlkVEpPUjFrd2NtSTVNbmRuSzBNeU9IbDVPV2MzTjJjOVBRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0K

}
resource "kubernetes_namespace" "test" {
  metadata {
    name = "mynginx1"
  }
}
resource "kubernetes_deployment" "test" {
  metadata {
    name      = "nginx"
    namespace = kubernetes_namespace.test.metadata[0].name
  }
  spec {
    replicas = 2
    selector {
      match_labels = {
        app = "MyTestApp"
      }
    }
    template {
      metadata {
        labels = {
          app = "MyTestApp"
        }
      }
      spec {
        container {
          image = "nginx"
          name  = "nginx-container"
          port {
            container_port = 80
          }
        }
      }
    }
  }
}
resource "kubernetes_service" "test" {
  metadata {
    name      = "nginx"
    namespace = kubernetes_namespace.test.metadata[0].name
  }
  spec {
    selector = {
      app = kubernetes_deployment.test.spec[0].template[0].metadata[0].labels.app
    }
    type = "NodePort"
    port {
      node_port   = 30201
      port        = 80
      target_port = 80
    }
  }
}










